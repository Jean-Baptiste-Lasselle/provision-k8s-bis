#!/bin/bash

# --------------------------------------------------------------------------------------------------------------------------------------------
##############################################################################################################################################
################                                                ENVIRONNEMENT                                            #####################
##############################################################################################################################################
# --------------------------------------------------------------------------------------------------------------------------------------------

# export MAISON=`pwd`
# export ADRESSE_IP_K8S_API_SERVER_PAR_DEFAUT=0.0.0.0
# export NO_PORT_IP_K8S_API_SERVER_PAR_DEFAUT=6443
# export VERSION_K8S_PAR_DEFAUT=v1.11.0

# --------------------------------------------------------------------------------------------------------------------------------------------
##############################################################################################################################################
################                                                OPERATIONS                                               #####################
##############################################################################################################################################
# --------------------------------------------------------------------------------------------------------------------------------------------

clear
echo " ---------------------------------------------------- "
echo " ---------------------------------------------------- "
echo " ---------------------------------------------------- "
echo " ------------ PROVISION TERMINEE : ---------------- "
echo " ------------ ++ kubeadm ---------------- "
echo " ------------ ++ kubectl ---------------- "
echo " ------------ ++ kubelet ---------------- "
echo " ---------------------------------------------------- "
echo " ---------------------------------------------------- "
echo " ---------------------------------------------------- "

# - Comment rejoindre le cluster?

echo "Vous avez choisi de transformer cette machine en esclave du maître "
echo " ---------------------------------------------------- "
echo "  ESSAI: Veuillez exécutez l'instruction de la forme:"
echo " ---------------------------------------------------- "

# - Les maîtres utilisent l'option [--node-name] de [kubeadm init] pour faire leur set-node-name
# - Les maîtres esclaves utilisent l'option [--hostname-override=$K8S_NODE_NAME] de [kubelet] pour faire leur set-node-name
echo " ---------------------------------------------------- "
echo "       [kubelet --hostname-override=$K8S_NODE_NAME]   "
echo " ---------------------------------------------------- "
echo "  Pour que cette machine prenne le nom [$K8S_NODE_NAME] dans ce "
echo "  cluster "
echo " "
echo " ---------------------------------------------------- "
echo "  Veuillez exécutez l'instruction de la forme:"
echo " ---------------------------------------------------- "
echo " "
echo "     [sudo kubeadm join $ADRESSE_IP_K8S_API_SERVER:$NO_PORT_IP_K8S_API_SERVER --token <valeur-du-token> --discovery-token-ca-cert-hash <valeur-du-token-hash-de-autorite-certif>]"
echo " "
echo "       avec l'option [ --node-name=$K8S_NODE_NAME]   "
echo "       --    "
echo " ---------------------------------------------------- "
echo "  Pour que cette machine devienne un esclave de ce "
echo "  cluster "
echo " ---------------------------------------------------- "